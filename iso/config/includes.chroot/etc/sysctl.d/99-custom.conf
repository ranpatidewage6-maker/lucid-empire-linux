# =============================================================================
# Lucid Empire v5.0-TITAN - Kernel Network Stack Configuration
# =============================================================================
# These parameters configure the Linux kernel's TCP/IP stack for optimal
# compatibility with the TITAN network masquerading layer.
# Source: Unified Agent [cite: 1]
#
# WARNING: Some parameters are intentionally set to mimic Windows/macOS
# signatures. The eBPF layer provides dynamic per-packet overrides.

# --- Filesystem Limits ---
fs.inotify.max_user_watches = 1048576
fs.inotify.max_user_instances = 1024

# --- TCP Keepalive (Standard) ---
net.ipv4.tcp_keepalive_time = 600
net.ipv4.tcp_keepalive_intvl = 60
net.ipv4.tcp_keepalive_probes = 5

# --- TCP/IP Stack Parameters for Fingerprint Masquerading ---
# These are baseline values. The eBPF XDP layer overrides these
# dynamically based on the active persona (Windows/macOS/Linux).
# Source: [cite: 1]

# Default TTL (Linux default is 64, Windows is 128, macOS is 64)
# This value is overridden by the eBPF program per-packet.
net.ipv4.ip_default_ttl = 64

# TCP Window Scaling (required for modern networks)
net.ipv4.tcp_window_scaling = 1

# TCP Maximum Segment Size (standard)
# net.ipv4.tcp_mss = 1460  # Usually auto-negotiated

# Enable SYN cookies for protection against SYN flood attacks
net.ipv4.tcp_syncookies = 1

# TCP timestamps (can be used for fingerprinting if inconsistent)
net.ipv4.tcp_timestamps = 1

# TCP Selective Acknowledgements
net.ipv4.tcp_sack = 1

# --- eBPF / BPF JIT Compilation ---
# Enable BPF JIT for performance of eBPF programs
# Source: [cite: 14, 16]
net.core.bpf_jit_enable = 1

# Harden BPF JIT (prevent JIT spraying attacks)
net.core.bpf_jit_harden = 0

# --- Network Buffer Sizes ---
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216

# --- IP Forwarding (Disabled by default for security) ---
net.ipv4.ip_forward = 0
net.ipv6.conf.all.forwarding = 0

# --- Disable ICMP Redirects (Security Hardening) ---
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0

# --- Disable Source Routing ---
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.default.accept_source_route = 0

# --- Kernel Randomization (ASLR) ---
kernel.randomize_va_space = 2
